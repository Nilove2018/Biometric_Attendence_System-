function doGet(e) {
  return handleRequest(e);
}

function doPost(e) {
  return handleRequest(e);
}

function handleRequest(e) {
  var sheet = SpreadsheetApp.openById("1gUqcBd2Y0wezhWbV_am2AF8r-GeDF-oO2T0dRsBmEfE").getActiveSheet();
  
  try {
    var name = e.parameter.name;
    var id = e.parameter.id;
    
    if (name && id) {
      // Format date as per IST (DD/MM/YY HH:MM)
      var date = new Date();
      date = Utilities.formatDate(date, "Asia/Kolkata", "dd/MM/yy HH:mm");
      
      sheet.appendRow([date, name, id]);
      return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
    } else {
      return ContentService.createTextOutput("Error: Missing Data").setMimeType(ContentService.MimeType.TEXT);
    }
  } catch (error) {
    return ContentService.createTextOutput("Error: " + error.message).setMimeType(ContentService.MimeType.TEXT);
  }
}
